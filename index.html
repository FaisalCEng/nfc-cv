/* ---------------- خلفية تفاعلية خفيفة ---------------- */
const canvas = document.getElementById("networkCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth; 
canvas.height = window.innerHeight;

let nodes = [];
let mouse = {x:null, y:null};

// تحديد عدد النقاط حسب الجهاز
const isMobile = /Mobi|Android/i.test(navigator.userAgent);
const numNodes = isMobile ? 60 : 100;

for(let i=0; i<numNodes; i++){
  nodes.push({
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height,
    vx: (Math.random()-0.5)*0.8, // أقل سرعة
    vy: (Math.random()-0.5)*0.8
  });
}

window.addEventListener("mousemove", e => { mouse.x = e.clientX; mouse.y = e.clientY; });
window.addEventListener("resize", () => { canvas.width = window.innerWidth; canvas.height = window.innerHeight; });
window.addEventListener("scroll", () => {
  nodes.forEach(n => {
    n.x += (Math.random()-0.5)*2; // أقل حركة عند التمرير
    n.y += (Math.random()-0.5)*2;
  });
});

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  nodes.forEach(n => {
    ctx.beginPath();
    ctx.arc(n.x,n.y,2,0,Math.PI*2);
    ctx.fillStyle="#00e0ff";
    ctx.fill();

    // خطوط بين النقاط القريبة
    nodes.forEach(o=>{
      let dx = n.x - o.x, dy = n.y - o.y, dist = Math.sqrt(dx*dx + dy*dy);
      if(dist<120){
        ctx.beginPath();
        ctx.moveTo(n.x,n.y);
        ctx.lineTo(o.x,o.y);
        ctx.strokeStyle="rgba(0,224,255,0.15)";
        ctx.stroke();
      }
    });

    // تفاعل مع الماوس
    if(mouse.x && mouse.y){
      let dx = n.x - mouse.x, dy = n.y - mouse.y, dist = Math.sqrt(dx*dx + dy*dy);
      if(dist < 100){
        ctx.beginPath();
        ctx.moveTo(n.x,n.y);
        ctx.lineTo(mouse.x,mouse.y);
        ctx.strokeStyle="rgba(0,255,255,0.3)";
        ctx.stroke();
      }
    }

    n.x += n.vx; n.y += n.vy;
    if(n.x<0 || n.x>canvas.width) n.vx*=-1;
    if(n.y<0 || n.y>canvas.height) n.vy*=-1;
  });
  requestAnimationFrame(draw);
}
draw();
